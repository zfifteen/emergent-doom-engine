#!/bin/bash
# shellcheck disable=SC2164

# This shell script tests 'FactorizationExperiment' with each semi prime contained in 'scripts/semi_primes.txt'
# It logs results to docs/findings/batch_factorization_results.log

PROJECT_ROOT="/Users/velocityworks/IdeaProjects/emergent-doom-engine"
JAR_PATH="$PROJECT_ROOT/target/emergent-doom-engine-0.1.0-alpha.jar"
LOG_FILE="$PROJECT_ROOT/scripts/run_factorization_experiment.log"

cd "$PROJECT_ROOT"

# Ensure log directory exists
mkdir -p "$(dirname "$LOG_FILE")"
echo "Batch Factorization Experiment Started: $(date)" > "$LOG_FILE"

# Build the project
echo "Building project..."
mvn clean package -DskipTests >> "$LOG_FILE" 2>&1

# Helper function to run a single experiment
# Usage: run_exp <target> <trials> <arraySize> <threads>
run_exp() {
    local target=$1
    local trials=$2
    local arraySize=$3
    local threads=$4

    echo "Testing target: $target (Trials: $trials, ArraySize: $arraySize, Threads: $threads)" | tee -a "$LOG_FILE"
    java -cp "$JAR_PATH" com.emergent.doom.examples.FactorizationExperiment "$target" "$trials" "$arraySize" "$threads" >> "$LOG_FILE" 2>&1
    echo "------------------------------------------------------------" >> "$LOG_FILE"
}

# Parameters
TRIALS=10
ARRAY_SIZE=1000
THREADS=4

# 1e4
#run_exp 10967 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 12961 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10901 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 12883 $TRIALS $ARRAY_SIZE $THREADS
run_exp 10747 $TRIALS $ARRAY_SIZE $THREADS

# 1e5
#run_exp 100697 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 102691 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100091 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 102073 $TRIALS $ARRAY_SIZE $THREADS
run_exp 100631 $TRIALS $ARRAY_SIZE $THREADS

# 1e6
#run_exp 1005973 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1009961 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 999919 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1003883 $TRIALS $ARRAY_SIZE $THREADS
run_exp 1001677 $TRIALS $ARRAY_SIZE $THREADS

# 1e7
#run_exp 10006889 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10008883 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000181 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10002163 $TRIALS $ARRAY_SIZE $THREADS
run_exp 9996127 $TRIALS $ARRAY_SIZE $THREADS

# 1e8
#run_exp 100000097 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100012061 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 99992891 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100004783 $TRIALS $ARRAY_SIZE $THREADS
run_exp 100007471 $TRIALS $ARRAY_SIZE $THREADS

# 1e9
#run_exp 999997979 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000009943 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 999999271 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000009181 $TRIALS $ARRAY_SIZE $THREADS
run_exp 999999019 $TRIALS $ARRAY_SIZE $THREADS

# 1e10
#run_exp 10000000727 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000012691 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 9999999647 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000005593 $TRIALS $ARRAY_SIZE $THREADS
run_exp 10000001003 $TRIALS $ARRAY_SIZE $THREADS

# 1e11
#run_exp 99999998297 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000010261 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 99999999443 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000005389 $TRIALS $ARRAY_SIZE $THREADS
run_exp 100000001183 $TRIALS $ARRAY_SIZE $THREADS

# 1e12
#run_exp 999999999919 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000003907 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000003349 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000005331 $TRIALS $ARRAY_SIZE $THREADS
run_exp 1000000002983 $TRIALS $ARRAY_SIZE $THREADS

# 1e13
#run_exp 10000000000187 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000006169 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000000787 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000006733 $TRIALS $ARRAY_SIZE $THREADS
run_exp 10000000020983 $TRIALS $ARRAY_SIZE $THREADS

# 1e14
#run_exp 100000000000873 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000000004861 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000000000933 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000000004897 $TRIALS $ARRAY_SIZE $THREADS
run_exp 100000000200983 $TRIALS $ARRAY_SIZE $THREADS

# 1e15
#run_exp 999999999999757 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000000001751 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000000000411 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000000006357 $TRIALS $ARRAY_SIZE $THREADS
run_exp 1000000002000983 $TRIALS $ARRAY_SIZE $THREADS

# 1e16
#run_exp 10000000000000561 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000000008537 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000000001137 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000000007083 $TRIALS $ARRAY_SIZE $THREADS
run_exp 10000000020000983 $TRIALS $ARRAY_SIZE $THREADS

# 1e17
#run_exp 999999999999999271 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000000000009241 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000000000000469 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 100000000000004433 $TRIALS $ARRAY_SIZE $THREADS
run_exp 100000000200000983 $TRIALS $ARRAY_SIZE $THREADS

# 1e18
#run_exp 9999999999999999689 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 10000000000000005671 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 999999999999999735 $TRIALS $ARRAY_SIZE $THREADS
#run_exp 1000000000000005681 $TRIALS $ARRAY_SIZE $THREADS
run_exp 1000000002000000983 $TRIALS $ARRAY_SIZE $THREADS

echo "Batch experiment complete. Results logged to $LOG_FILE"
